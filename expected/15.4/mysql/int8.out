--
-- MySql
-- INT8
-- Test int8 64-bit integers.
--
\set ECHO none
\i sql/15.4/int8.sql
--Testcase 1:
CREATE EXTENSION IF NOT EXISTS :DB_EXTENSIONNAME;
--Testcase 2:
CREATE SERVER :DB_SERVERNAME FOREIGN DATA WRAPPER :DB_EXTENSIONNAME
            OPTIONS (odbc_DRIVER :DB_DRIVERNAME,
                    odbc_SERVER :DB_SERVER,
					odbc_PORT :DB_PORT,
					odbc_DATABASE :DB_DATABASE
			);
--Testcase 3:
CREATE USER MAPPING FOR public SERVER :DB_SERVERNAME OPTIONS(odbc_UID :DB_USER, odbc_PWD :DB_PASS);
--Testcase 4:
CREATE FOREIGN TABLE INT8_TBL(id serial OPTIONS (key 'true'), q1 int8, q2 int8) SERVER :DB_SERVERNAME OPTIONS (schema :DB_SCHEMA, table 'int8_tbl'); 
-- bad inputs
--Testcase 6:
INSERT INTO INT8_TBL(q1) VALUES ('      ');
psql:sql/15.4/int8.sql:17: ERROR:  invalid input syntax for type bigint: "      "
LINE 1: INSERT INTO INT8_TBL(q1) VALUES ('      ');
                                         ^
--Testcase 7:
INSERT INTO INT8_TBL(q1) VALUES ('xxx');
psql:sql/15.4/int8.sql:19: ERROR:  invalid input syntax for type bigint: "xxx"
LINE 1: INSERT INTO INT8_TBL(q1) VALUES ('xxx');
                                         ^
--Testcase 8:
INSERT INTO INT8_TBL(q1) VALUES ('3908203590239580293850293850329485');
psql:sql/15.4/int8.sql:21: ERROR:  value "3908203590239580293850293850329485" is out of range for type bigint
LINE 1: INSERT INTO INT8_TBL(q1) VALUES ('39082035902395802938502938...
                                         ^
--Testcase 9:
INSERT INTO INT8_TBL(q1) VALUES ('-1204982019841029840928340329840934');
psql:sql/15.4/int8.sql:23: ERROR:  value "-1204982019841029840928340329840934" is out of range for type bigint
LINE 1: INSERT INTO INT8_TBL(q1) VALUES ('-1204982019841029840928340...
                                         ^
--Testcase 10:
INSERT INTO INT8_TBL(q1) VALUES ('- 123');
psql:sql/15.4/int8.sql:25: ERROR:  invalid input syntax for type bigint: "- 123"
LINE 1: INSERT INTO INT8_TBL(q1) VALUES ('- 123');
                                         ^
--Testcase 11:
INSERT INTO INT8_TBL(q1) VALUES ('  345     5');
psql:sql/15.4/int8.sql:27: ERROR:  invalid input syntax for type bigint: "  345     5"
LINE 1: INSERT INTO INT8_TBL(q1) VALUES ('  345     5');
                                         ^
--Testcase 12:
INSERT INTO INT8_TBL(q1) VALUES ('');
psql:sql/15.4/int8.sql:29: ERROR:  invalid input syntax for type bigint: ""
LINE 1: INSERT INTO INT8_TBL(q1) VALUES ('');
                                         ^
--Testcase 13:
SELECT q1, q2 FROM INT8_TBL;
        q1        |        q2         
------------------+-------------------
              123 |               456
              123 |  4567890123456789
 4567890123456789 |               123
 4567890123456789 |  4567890123456789
 4567890123456789 | -4567890123456789
(5 rows)

-- int8/int8 cmp
--Testcase 14:
SELECT q1, q2 FROM INT8_TBL WHERE q2 = 4567890123456789;
        q1        |        q2        
------------------+------------------
              123 | 4567890123456789
 4567890123456789 | 4567890123456789
(2 rows)

--Testcase 15:
SELECT q1, q2 FROM INT8_TBL WHERE q2 <> 4567890123456789;
        q1        |        q2         
------------------+-------------------
              123 |               456
 4567890123456789 |               123
 4567890123456789 | -4567890123456789
(3 rows)

--Testcase 16:
SELECT q1, q2 FROM INT8_TBL WHERE q2 < 4567890123456789;
        q1        |        q2         
------------------+-------------------
              123 |               456
 4567890123456789 |               123
 4567890123456789 | -4567890123456789
(3 rows)

--Testcase 17:
SELECT q1, q2 FROM INT8_TBL WHERE q2 > 4567890123456789;
 q1 | q2 
----+----
(0 rows)

--Testcase 18:
SELECT q1, q2 FROM INT8_TBL WHERE q2 <= 4567890123456789;
        q1        |        q2         
------------------+-------------------
              123 |               456
              123 |  4567890123456789
 4567890123456789 |               123
 4567890123456789 |  4567890123456789
 4567890123456789 | -4567890123456789
(5 rows)

--Testcase 19:
SELECT q1, q2 FROM INT8_TBL WHERE q2 >= 4567890123456789;
        q1        |        q2        
------------------+------------------
              123 | 4567890123456789
 4567890123456789 | 4567890123456789
(2 rows)

-- int8/int4 cmp
--Testcase 20:
SELECT q1, q2 FROM INT8_TBL WHERE q2 = 456;
 q1  | q2  
-----+-----
 123 | 456
(1 row)

--Testcase 21:
SELECT q1, q2 FROM INT8_TBL WHERE q2 <> 456;
        q1        |        q2         
------------------+-------------------
              123 |  4567890123456789
 4567890123456789 |               123
 4567890123456789 |  4567890123456789
 4567890123456789 | -4567890123456789
(4 rows)

--Testcase 22:
SELECT q1, q2 FROM INT8_TBL WHERE q2 < 456;
        q1        |        q2         
------------------+-------------------
 4567890123456789 |               123
 4567890123456789 | -4567890123456789
(2 rows)

--Testcase 23:
SELECT q1, q2 FROM INT8_TBL WHERE q2 > 456;
        q1        |        q2        
------------------+------------------
              123 | 4567890123456789
 4567890123456789 | 4567890123456789
(2 rows)

--Testcase 24:
SELECT q1, q2 FROM INT8_TBL WHERE q2 <= 456;
        q1        |        q2         
------------------+-------------------
              123 |               456
 4567890123456789 |               123
 4567890123456789 | -4567890123456789
(3 rows)

--Testcase 25:
SELECT q1, q2 FROM INT8_TBL WHERE q2 >= 456;
        q1        |        q2        
------------------+------------------
              123 |              456
              123 | 4567890123456789
 4567890123456789 | 4567890123456789
(3 rows)

-- int4/int8 cmp
--Testcase 26:
SELECT q1, q2 FROM INT8_TBL WHERE 123 = q1;
 q1  |        q2        
-----+------------------
 123 |              456
 123 | 4567890123456789
(2 rows)

--Testcase 27:
SELECT q1, q2 FROM INT8_TBL WHERE 123 <> q1;
        q1        |        q2         
------------------+-------------------
 4567890123456789 |               123
 4567890123456789 |  4567890123456789
 4567890123456789 | -4567890123456789
(3 rows)

--Testcase 28:
SELECT q1, q2 FROM INT8_TBL WHERE 123 < q1;
        q1        |        q2         
------------------+-------------------
 4567890123456789 |               123
 4567890123456789 |  4567890123456789
 4567890123456789 | -4567890123456789
(3 rows)

--Testcase 29:
SELECT q1, q2 FROM INT8_TBL WHERE 123 > q1;
 q1 | q2 
----+----
(0 rows)

--Testcase 30:
SELECT q1, q2 FROM INT8_TBL WHERE 123 <= q1;
        q1        |        q2         
------------------+-------------------
              123 |               456
              123 |  4567890123456789
 4567890123456789 |               123
 4567890123456789 |  4567890123456789
 4567890123456789 | -4567890123456789
(5 rows)

--Testcase 31:
SELECT q1, q2 FROM INT8_TBL WHERE 123 >= q1;
 q1  |        q2        
-----+------------------
 123 |              456
 123 | 4567890123456789
(2 rows)

-- int8/int2 cmp
--Testcase 32:
SELECT q1, q2 FROM INT8_TBL WHERE q2 = '456'::int2;
 q1  | q2  
-----+-----
 123 | 456
(1 row)

--Testcase 33:
SELECT q1, q2 FROM INT8_TBL WHERE q2 <> '456'::int2;
        q1        |        q2         
------------------+-------------------
              123 |  4567890123456789
 4567890123456789 |               123
 4567890123456789 |  4567890123456789
 4567890123456789 | -4567890123456789
(4 rows)

--Testcase 34:
SELECT q1, q2 FROM INT8_TBL WHERE q2 < '456'::int2;
        q1        |        q2         
------------------+-------------------
 4567890123456789 |               123
 4567890123456789 | -4567890123456789
(2 rows)

--Testcase 35:
SELECT q1, q2 FROM INT8_TBL WHERE q2 > '456'::int2;
        q1        |        q2        
------------------+------------------
              123 | 4567890123456789
 4567890123456789 | 4567890123456789
(2 rows)

--Testcase 36:
SELECT q1, q2 FROM INT8_TBL WHERE q2 <= '456'::int2;
        q1        |        q2         
------------------+-------------------
              123 |               456
 4567890123456789 |               123
 4567890123456789 | -4567890123456789
(3 rows)

--Testcase 37:
SELECT q1, q2 FROM INT8_TBL WHERE q2 >= '456'::int2;
        q1        |        q2        
------------------+------------------
              123 |              456
              123 | 4567890123456789
 4567890123456789 | 4567890123456789
(3 rows)

-- int2/int8 cmp
--Testcase 38:
SELECT q1, q2 FROM INT8_TBL WHERE '123'::int2 = q1;
 q1  |        q2        
-----+------------------
 123 |              456
 123 | 4567890123456789
(2 rows)

--Testcase 39:
SELECT q1, q2 FROM INT8_TBL WHERE '123'::int2 <> q1;
        q1        |        q2         
------------------+-------------------
 4567890123456789 |               123
 4567890123456789 |  4567890123456789
 4567890123456789 | -4567890123456789
(3 rows)

--Testcase 40:
SELECT q1, q2 FROM INT8_TBL WHERE '123'::int2 < q1;
        q1        |        q2         
------------------+-------------------
 4567890123456789 |               123
 4567890123456789 |  4567890123456789
 4567890123456789 | -4567890123456789
(3 rows)

--Testcase 41:
SELECT q1, q2 FROM INT8_TBL WHERE '123'::int2 > q1;
 q1 | q2 
----+----
(0 rows)

--Testcase 42:
SELECT q1, q2 FROM INT8_TBL WHERE '123'::int2 <= q1;
        q1        |        q2         
------------------+-------------------
              123 |               456
              123 |  4567890123456789
 4567890123456789 |               123
 4567890123456789 |  4567890123456789
 4567890123456789 | -4567890123456789
(5 rows)

--Testcase 43:
SELECT q1, q2 FROM INT8_TBL WHERE '123'::int2 >= q1;
 q1  |        q2        
-----+------------------
 123 |              456
 123 | 4567890123456789
(2 rows)

--Testcase 44:
SELECT q1 AS plus, -q1 AS minus FROM INT8_TBL;
       plus       |       minus       
------------------+-------------------
              123 |              -123
              123 |              -123
 4567890123456789 | -4567890123456789
 4567890123456789 | -4567890123456789
 4567890123456789 | -4567890123456789
(5 rows)

--Testcase 45:
SELECT q1, q2, q1 + q2 AS plus FROM INT8_TBL;
        q1        |        q2         |       plus       
------------------+-------------------+------------------
              123 |               456 |              579
              123 |  4567890123456789 | 4567890123456912
 4567890123456789 |               123 | 4567890123456912
 4567890123456789 |  4567890123456789 | 9135780246913578
 4567890123456789 | -4567890123456789 |                0
(5 rows)

--Testcase 46:
SELECT q1, q2, q1 - q2 AS minus FROM INT8_TBL;
        q1        |        q2         |       minus       
------------------+-------------------+-------------------
              123 |               456 |              -333
              123 |  4567890123456789 | -4567890123456666
 4567890123456789 |               123 |  4567890123456666
 4567890123456789 |  4567890123456789 |                 0
 4567890123456789 | -4567890123456789 |  9135780246913578
(5 rows)

--Testcase 47:
SELECT q1, q2, q1 * q2 AS multiply FROM INT8_TBL;
psql:sql/15.4/int8.sql:113: ERROR:  bigint out of range
--Testcase 48:
SELECT q1, q2, q1 * q2 AS multiply FROM INT8_TBL
 WHERE q1 < 1000 or (q2 > 0 and q2 < 1000);
        q1        |        q2        |      multiply      
------------------+------------------+--------------------
              123 |              456 |              56088
              123 | 4567890123456789 | 561850485185185047
 4567890123456789 |              123 | 561850485185185047
(3 rows)

--Testcase 49:
SELECT q1, q2, q1 / q2 AS divide, q1 % q2 AS mod FROM INT8_TBL;
        q1        |        q2         |     divide     | mod 
------------------+-------------------+----------------+-----
              123 |               456 |              0 | 123
              123 |  4567890123456789 |              0 | 123
 4567890123456789 |               123 | 37137318076884 |  57
 4567890123456789 |  4567890123456789 |              1 |   0
 4567890123456789 | -4567890123456789 |             -1 |   0
(5 rows)

--Testcase 50:
SELECT q1, float8(q1) FROM INT8_TBL;
        q1        |        float8         
------------------+-----------------------
              123 |                   123
              123 |                   123
 4567890123456789 | 4.567890123456789e+15
 4567890123456789 | 4.567890123456789e+15
 4567890123456789 | 4.567890123456789e+15
(5 rows)

--Testcase 51:
SELECT q2, float8(q2) FROM INT8_TBL;
        q2         |         float8         
-------------------+------------------------
               456 |                    456
  4567890123456789 |  4.567890123456789e+15
               123 |                    123
  4567890123456789 |  4.567890123456789e+15
 -4567890123456789 | -4.567890123456789e+15
(5 rows)

--Testcase 52:
SELECT 37 + q1 AS plus4 FROM INT8_TBL;
      plus4       
------------------
              160
              160
 4567890123456826
 4567890123456826
 4567890123456826
(5 rows)

--Testcase 53:
SELECT 37 - q1 AS minus4 FROM INT8_TBL;
      minus4       
-------------------
               -86
               -86
 -4567890123456752
 -4567890123456752
 -4567890123456752
(5 rows)

--Testcase 54:
SELECT 2 * q1 AS "twice int4" FROM INT8_TBL;
    twice int4    
------------------
              246
              246
 9135780246913578
 9135780246913578
 9135780246913578
(5 rows)

--Testcase 55:
SELECT q1 * 2 AS "twice int4" FROM INT8_TBL;
    twice int4    
------------------
              246
              246
 9135780246913578
 9135780246913578
 9135780246913578
(5 rows)

-- int8 op int4
--Testcase 56:
SELECT q1 + 42::int4 AS "8plus4", q1 - 42::int4 AS "8minus4", q1 * 42::int4 AS "8mul4", q1 / 42::int4 AS "8div4" FROM INT8_TBL;
      8plus4      |     8minus4      |       8mul4        |      8div4      
------------------+------------------+--------------------+-----------------
              165 |               81 |               5166 |               2
              165 |               81 |               5166 |               2
 4567890123456831 | 4567890123456747 | 191851385185185138 | 108759288653733
 4567890123456831 | 4567890123456747 | 191851385185185138 | 108759288653733
 4567890123456831 | 4567890123456747 | 191851385185185138 | 108759288653733
(5 rows)

-- int4 op int8
--Testcase 57:
SELECT 246::int4 + q1 AS "4plus8", 246::int4 - q1 AS "4minus8", 246::int4 * q1 AS "4mul8", 246::int4 / q1 AS "4div8" FROM INT8_TBL;
      4plus8      |      4minus8      |        4mul8        | 4div8 
------------------+-------------------+---------------------+-------
              369 |               123 |               30258 |     2
              369 |               123 |               30258 |     2
 4567890123457035 | -4567890123456543 | 1123700970370370094 |     0
 4567890123457035 | -4567890123456543 | 1123700970370370094 |     0
 4567890123457035 | -4567890123456543 | 1123700970370370094 |     0
(5 rows)

-- int8 op int2
--Testcase 58:
SELECT q1 + 42::int2 AS "8plus2", q1 - 42::int2 AS "8minus2", q1 * 42::int2 AS "8mul2", q1 / 42::int2 AS "8div2" FROM INT8_TBL;
      8plus2      |     8minus2      |       8mul2        |      8div2      
------------------+------------------+--------------------+-----------------
              165 |               81 |               5166 |               2
              165 |               81 |               5166 |               2
 4567890123456831 | 4567890123456747 | 191851385185185138 | 108759288653733
 4567890123456831 | 4567890123456747 | 191851385185185138 | 108759288653733
 4567890123456831 | 4567890123456747 | 191851385185185138 | 108759288653733
(5 rows)

-- int2 op int8
--Testcase 59:
SELECT 246::int2 + q1 AS "2plus8", 246::int2 - q1 AS "2minus8", 246::int2 * q1 AS "2mul8", 246::int2 / q1 AS "2div8" FROM INT8_TBL;
      2plus8      |      2minus8      |        2mul8        | 2div8 
------------------+-------------------+---------------------+-------
              369 |               123 |               30258 |     2
              369 |               123 |               30258 |     2
 4567890123457035 | -4567890123456543 | 1123700970370370094 |     0
 4567890123457035 | -4567890123456543 | 1123700970370370094 |     0
 4567890123457035 | -4567890123456543 | 1123700970370370094 |     0
(5 rows)

--Testcase 60:
SELECT q2, abs(q2) FROM INT8_TBL;
        q2         |       abs        
-------------------+------------------
               456 |              456
  4567890123456789 | 4567890123456789
               123 |              123
  4567890123456789 | 4567890123456789
 -4567890123456789 | 4567890123456789
(5 rows)

--Testcase 61:
SELECT min(q1), min(q2) FROM INT8_TBL;
 min |        min        
-----+-------------------
 123 | -4567890123456789
(1 row)

--Testcase 62:
SELECT max(q1), max(q2) FROM INT8_TBL;
       max        |       max        
------------------+------------------
 4567890123456789 | 4567890123456789
(1 row)

-- TO_CHAR()
--
--Testcase 63:
SELECT to_char(q1, '9G999G999G999G999G999'), to_char(q2, '9,999,999,999,999,999')
	FROM INT8_TBL;
        to_char         |        to_char         
------------------------+------------------------
                    123 |                    456
                    123 |  4,567,890,123,456,789
  4,567,890,123,456,789 |                    123
  4,567,890,123,456,789 |  4,567,890,123,456,789
  4,567,890,123,456,789 | -4,567,890,123,456,789
(5 rows)

--Testcase 64:
SELECT to_char(q1, '9G999G999G999G999G999D999G999'), to_char(q2, '9,999,999,999,999,999.999,999')
	FROM INT8_TBL;
            to_char             |            to_char             
--------------------------------+--------------------------------
                    123.000,000 |                    456.000,000
                    123.000,000 |  4,567,890,123,456,789.000,000
  4,567,890,123,456,789.000,000 |                    123.000,000
  4,567,890,123,456,789.000,000 |  4,567,890,123,456,789.000,000
  4,567,890,123,456,789.000,000 | -4,567,890,123,456,789.000,000
(5 rows)

--Testcase 65:
SELECT to_char( (q1 * -1), '9999999999999999PR'), to_char( (q2 * -1), '9999999999999999.999PR')
	FROM INT8_TBL;
      to_char       |        to_char         
--------------------+------------------------
              <123> |              <456.000>
              <123> | <4567890123456789.000>
 <4567890123456789> |              <123.000>
 <4567890123456789> | <4567890123456789.000>
 <4567890123456789> |  4567890123456789.000 
(5 rows)

--Testcase 66:
SELECT to_char( (q1 * -1), '9999999999999999S'), to_char( (q2 * -1), 'S9999999999999999')
	FROM INT8_TBL;
      to_char      |      to_char      
-------------------+-------------------
              123- |              -456
              123- | -4567890123456789
 4567890123456789- |              -123
 4567890123456789- | -4567890123456789
 4567890123456789- | +4567890123456789
(5 rows)

--Testcase 67:
SELECT  to_char(q2, 'MI9999999999999999')     FROM INT8_TBL;
      to_char      
-------------------
               456
  4567890123456789
               123
  4567890123456789
 -4567890123456789
(5 rows)

--Testcase 68:
SELECT  to_char(q2, 'FMS9999999999999999')    FROM INT8_TBL;
      to_char      
-------------------
 +456
 +4567890123456789
 +123
 +4567890123456789
 -4567890123456789
(5 rows)

--Testcase 69:
SELECT  to_char(q2, 'FM9999999999999999THPR') FROM INT8_TBL;
      to_char       
--------------------
 456TH
 4567890123456789TH
 123RD
 4567890123456789TH
 <4567890123456789>
(5 rows)

--Testcase 70:
SELECT  to_char(q2, 'SG9999999999999999th')   FROM INT8_TBL;
       to_char       
---------------------
 +             456th
 +4567890123456789th
 +             123rd
 +4567890123456789th
 -4567890123456789
(5 rows)

--Testcase 71:
SELECT  to_char(q2, '0999999999999999')       FROM INT8_TBL;
      to_char      
-------------------
  0000000000000456
  4567890123456789
  0000000000000123
  4567890123456789
 -4567890123456789
(5 rows)

--Testcase 72:
SELECT to_char(q2, 'S0999999999999999')      FROM INT8_TBL;
      to_char      
-------------------
 +0000000000000456
 +4567890123456789
 +0000000000000123
 +4567890123456789
 -4567890123456789
(5 rows)

--Testcase 73:
SELECT to_char(q2, 'FM0999999999999999')     FROM INT8_TBL;
      to_char      
-------------------
 0000000000000456
 4567890123456789
 0000000000000123
 4567890123456789
 -4567890123456789
(5 rows)

--Testcase 74:
SELECT to_char(q2, 'FM9999999999999999.000') FROM INT8_TBL;
        to_char        
-----------------------
 456.000
 4567890123456789.000
 123.000
 4567890123456789.000
 -4567890123456789.000
(5 rows)

--Testcase 75:
SELECT to_char(q2, 'L9999999999999999.000')  FROM INT8_TBL;
        to_char         
------------------------
                456.000
   4567890123456789.000
                123.000
   4567890123456789.000
  -4567890123456789.000
(5 rows)

--Testcase 76:
SELECT to_char(q2, 'FM9999999999999999.999') FROM INT8_TBL;
      to_char       
--------------------
 456.
 4567890123456789.
 123.
 4567890123456789.
 -4567890123456789.
(5 rows)

--Testcase 77:
SELECT to_char(q2, 'S 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 9 . 9 9 9') FROM INT8_TBL;
                  to_char                  
-------------------------------------------
                            +4 5 6 . 0 0 0
  +4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 . 0 0 0
                            +1 2 3 . 0 0 0
  +4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 . 0 0 0
  -4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 . 0 0 0
(5 rows)

--Testcase 78:
SELECT to_char(q2, E'99999 "text" 9999 "9999" 999 "\\"text between quote marks\\"" 9999') FROM INT8_TBL;
                          to_char                          
-----------------------------------------------------------
       text      9999     "text between quote marks"   456
  45678 text 9012 9999 345 "text between quote marks" 6789
       text      9999     "text between quote marks"   123
  45678 text 9012 9999 345 "text between quote marks" 6789
 -45678 text 9012 9999 345 "text between quote marks" 6789
(5 rows)

--Testcase 79:
SELECT to_char(q2, '999999SG9999999999')     FROM INT8_TBL;
      to_char      
-------------------
       +       456
 456789+0123456789
       +       123
 456789+0123456789
 456789-0123456789
(5 rows)

-- check min/max values and overflow behavior
--Testcase 80:
ALTER FOREIGN TABLE INT8_TBL OPTIONS (SET table 'int8_tbl_tmp');
--Testcase 81:
INSERT INTO INT8_TBL(q1) VALUES ('-9223372036854775808'::int8);
--Testcase 82:
SELECT q1 FROM INT8_TBL;
          q1          
----------------------
 -9223372036854775808
(1 row)

--Testcase 83:
DELETE FROM INT8_TBL;
--Testcase 84:
INSERT INTO INT8_TBL(q1) VALUES ('-9223372036854775809'::int8);
psql:sql/15.4/int8.sql:212: ERROR:  value "-9223372036854775809" is out of range for type bigint
LINE 1: INSERT INTO INT8_TBL(q1) VALUES ('-9223372036854775809'::int...
                                         ^
--Testcase 86:
DELETE FROM INT8_TBL;
--Testcase 87:
INSERT INTO INT8_TBL(q1) VALUES ('9223372036854775807'::int8);
--Testcase 88:
SELECT q1 FROM INT8_TBL;
         q1          
---------------------
 9223372036854775807
(1 row)

--Testcase 89:
DELETE FROM INT8_TBL;
--Testcase 90:
INSERT INTO INT8_TBL(q1) VALUES ('9223372036854775808'::int8);
psql:sql/15.4/int8.sql:222: ERROR:  value "9223372036854775808" is out of range for type bigint
LINE 1: INSERT INTO INT8_TBL(q1) VALUES ('9223372036854775808'::int8...
                                         ^
--Testcase 92:
DELETE FROM INT8_TBL;
--Testcase 93:
INSERT INTO INT8_TBL(q1) VALUES (-('-9223372036854775807'::int8));
--Testcase 94:
SELECT q1 FROM INT8_TBL;
         q1          
---------------------
 9223372036854775807
(1 row)

--Testcase 95:
DELETE FROM INT8_TBL;
--Testcase 96:
INSERT INTO INT8_TBL(q1) VALUES (-('-9223372036854775808'::int8));
psql:sql/15.4/int8.sql:232: ERROR:  bigint out of range
--Testcase 98:
DELETE FROM INT8_TBL;
--Testcase 99:
INSERT INTO INT8_TBL(q1) VALUES ('9223372036854775800'::int8 + '9223372036854775800'::int8);
psql:sql/15.4/int8.sql:236: ERROR:  bigint out of range
--Testcase 101:
DELETE FROM INT8_TBL;
--Testcase 102:
INSERT INTO INT8_TBL(q1) VALUES ('-9223372036854775800'::int8 + '-9223372036854775800'::int8);
psql:sql/15.4/int8.sql:240: ERROR:  bigint out of range
--Testcase 104:
DELETE FROM INT8_TBL;
--Testcase 105:
INSERT INTO INT8_TBL(q1) VALUES ('9223372036854775800'::int8 - '-9223372036854775800'::int8);
psql:sql/15.4/int8.sql:244: ERROR:  bigint out of range
--Testcase 107:
DELETE FROM INT8_TBL;
--Testcase 108:
INSERT INTO INT8_TBL(q1) VALUES ('-9223372036854775800'::int8 - '9223372036854775800'::int8);
psql:sql/15.4/int8.sql:248: ERROR:  bigint out of range
--Testcase 110:
DELETE FROM INT8_TBL;
--Testcase 111:
INSERT INTO INT8_TBL(q1) VALUES ('9223372036854775800'::int8 * '9223372036854775800'::int8);
psql:sql/15.4/int8.sql:252: ERROR:  bigint out of range
--Testcase 113:
DELETE FROM INT8_TBL;
--Testcase 114:
INSERT INTO INT8_TBL(q1) VALUES ('9223372036854775800'::int8 / '0'::int8);
psql:sql/15.4/int8.sql:256: ERROR:  division by zero
--Testcase 116:
DELETE FROM INT8_TBL;
--Testcase 117:
INSERT INTO INT8_TBL(q1) VALUES ('9223372036854775800'::int8 % '0'::int8);
psql:sql/15.4/int8.sql:260: ERROR:  division by zero
--Testcase 119:
DELETE FROM INT8_TBL;
--Testcase 120:
INSERT INTO INT8_TBL(q1) VALUES (abs('-9223372036854775808'::int8));
psql:sql/15.4/int8.sql:264: ERROR:  bigint out of range
--Testcase 122:
DELETE FROM INT8_TBL;
--Testcase 123:
INSERT INTO INT8_TBL(q1) VALUES ('9223372036854775800'::int8 + '100'::int4);
psql:sql/15.4/int8.sql:268: ERROR:  bigint out of range
--Testcase 125:
DELETE FROM INT8_TBL;
--Testcase 126:
INSERT INTO INT8_TBL(q1) VALUES ('-9223372036854775800'::int8 - '100'::int4);
psql:sql/15.4/int8.sql:272: ERROR:  bigint out of range
--Testcase 128:
DELETE FROM INT8_TBL;
--Testcase 129:
INSERT INTO INT8_TBL(q1) VALUES ('9223372036854775800'::int8 * '100'::int4);
psql:sql/15.4/int8.sql:276: ERROR:  bigint out of range
--Testcase 131:
DELETE FROM INT8_TBL;
--Testcase 132:
INSERT INTO INT8_TBL(q1) VALUES ('100'::int4 + '9223372036854775800'::int8);
psql:sql/15.4/int8.sql:280: ERROR:  bigint out of range
--Testcase 134:
DELETE FROM INT8_TBL;
--Testcase 135:
INSERT INTO INT8_TBL(q1) VALUES ('-100'::int4 - '9223372036854775800'::int8);
psql:sql/15.4/int8.sql:284: ERROR:  bigint out of range
--Testcase 137:
DELETE FROM INT8_TBL;
--Testcase 138:
INSERT INTO INT8_TBL(q1) VALUES ('100'::int4 * '9223372036854775800'::int8);
psql:sql/15.4/int8.sql:288: ERROR:  bigint out of range
--Testcase 140:
DELETE FROM INT8_TBL;
--Testcase 141:
INSERT INTO INT8_TBL(q1) VALUES ('9223372036854775800'::int8 + '100'::int2);
psql:sql/15.4/int8.sql:292: ERROR:  bigint out of range
--Testcase 143:
DELETE FROM INT8_TBL;
--Testcase 144:
INSERT INTO INT8_TBL(q1) VALUES ('-9223372036854775800'::int8 - '100'::int2);
psql:sql/15.4/int8.sql:296: ERROR:  bigint out of range
--Testcase 146:
DELETE FROM INT8_TBL;
--Testcase 147:
INSERT INTO INT8_TBL(q1) VALUES ('9223372036854775800'::int8 * '100'::int2);
psql:sql/15.4/int8.sql:300: ERROR:  bigint out of range
--Testcase 149:
DELETE FROM INT8_TBL;
--Testcase 150:
INSERT INTO INT8_TBL(q1) VALUES ('-9223372036854775808'::int8 / '0'::int2);
psql:sql/15.4/int8.sql:304: ERROR:  division by zero
--Testcase 152:
DELETE FROM INT8_TBL;
--Testcase 153:
INSERT INTO INT8_TBL(q1) VALUES ('100'::int2 + '9223372036854775800'::int8);
psql:sql/15.4/int8.sql:308: ERROR:  bigint out of range
--Testcase 155:
DELETE FROM INT8_TBL;
--Testcase 156:
INSERT INTO INT8_TBL(q1) VALUES ('-100'::int2 - '9223372036854775800'::int8);
psql:sql/15.4/int8.sql:312: ERROR:  bigint out of range
--Testcase 158:
DELETE FROM INT8_TBL;
--Testcase 159:
INSERT INTO INT8_TBL(q1) VALUES ('100'::int2 * '9223372036854775800'::int8);
psql:sql/15.4/int8.sql:316: ERROR:  bigint out of range
--Testcase 161:
DELETE FROM INT8_TBL;
--Testcase 162:
INSERT INTO INT8_TBL(q1) VALUES ('100'::int2 / '0'::int8);
psql:sql/15.4/int8.sql:320: ERROR:  division by zero
ALTER FOREIGN TABLE INT8_TBL OPTIONS (SET table 'int8_tbl'); 
--Testcase 164:
SELECT CAST(q1 AS int4) FROM int8_tbl WHERE q2 = 456;
 q1  
-----
 123
(1 row)

--Testcase 165:
SELECT CAST(q1 AS int4) FROM int8_tbl WHERE q2 <> 456;
psql:sql/15.4/int8.sql:326: ERROR:  integer out of range
--Testcase 166:
SELECT CAST(q1 AS int2) FROM int8_tbl WHERE q2 = 456;
 q1  
-----
 123
(1 row)

--Testcase 167:
SELECT CAST(q1 AS int2) FROM int8_tbl WHERE q2 <> 456;
psql:sql/15.4/int8.sql:331: ERROR:  smallint out of range
ALTER FOREIGN TABLE INT8_TBL OPTIONS (SET table 'int8_tbl_tmp');
--Testcase 168:
DELETE FROM INT8_TBL;
--Testcase 169:
INSERT INTO INT8_TBL(q1,q2) VALUES ('42'::int2, '-37'::int2);
--Testcase 170:
SELECT CAST(q1 AS int8), CAST(q2 AS int8) FROM INT8_TBL;
 q1 | q2  
----+-----
 42 | -37
(1 row)

ALTER FOREIGN TABLE INT8_TBL OPTIONS (SET table 'int8_tbl'); 
--Testcase 171:
SELECT CAST(q1 AS float4), CAST(q2 AS float8) FROM INT8_TBL;
     q1      |           q2           
-------------+------------------------
         123 |                    456
         123 |  4.567890123456789e+15
 4.56789e+15 |                    123
 4.56789e+15 |  4.567890123456789e+15
 4.56789e+15 | -4.567890123456789e+15
(5 rows)

ALTER FOREIGN TABLE INT8_TBL OPTIONS (SET table 'int8_tbl_tmp'); 
--Testcase 172:
DELETE FROM INT8_TBL;
--Testcase 173:
INSERT INTO INT8_TBL(q1) VALUES ('36854775807.0'::float4);
--Testcase 174:
SELECT CAST(q1::float4 AS int8) FROM INT8_TBL;
     q1      
-------------
 36854775808
(1 row)

--Testcase 175:
DELETE FROM INT8_TBL;
--Testcase 176:
INSERT INTO INT8_TBL(q1) VALUES ('922337203685477580700.0'::float8);
psql:sql/15.4/int8.sql:356: ERROR:  bigint out of range
--Testcase 177:
SELECT CAST(q1::float8 AS int8) FROM INT8_TBL;
 q1 
----
(0 rows)

ALTER FOREIGN TABLE INT8_TBL OPTIONS (SET table 'int8_tbl'); 
--Testcase 178:
SELECT CAST(q1 AS oid) FROM INT8_TBL;
psql:sql/15.4/int8.sql:362: ERROR:  OID out of range
-- bit operations
--Testcase 179:
SELECT q1, q2, q1 & q2 AS "and", q1 | q2 AS "or", q1 # q2 AS "xor", ~q1 AS "not" FROM INT8_TBL;
        q1        |        q2         |       and        |        or        |       xor        |        not        
------------------+-------------------+------------------+------------------+------------------+-------------------
              123 |               456 |               72 |              507 |              435 |              -124
              123 |  4567890123456789 |               17 | 4567890123456895 | 4567890123456878 |              -124
 4567890123456789 |               123 |               17 | 4567890123456895 | 4567890123456878 | -4567890123456790
 4567890123456789 |  4567890123456789 | 4567890123456789 | 4567890123456789 |                0 | -4567890123456790
 4567890123456789 | -4567890123456789 |                1 |               -1 |               -2 | -4567890123456790
(5 rows)

--Testcase 180:
SELECT q1, q1 << 2 AS "shl", q1 >> 3 AS "shr" FROM INT8_TBL;
        q1        |        shl        |       shr       
------------------+-------------------+-----------------
              123 |               492 |              15
              123 |               492 |              15
 4567890123456789 | 18271560493827156 | 570986265432098
 4567890123456789 | 18271560493827156 | 570986265432098
 4567890123456789 | 18271560493827156 | 570986265432098
(5 rows)

-- generate_series
ALTER FOREIGN TABLE INT8_TBL OPTIONS (SET table 'int8_tbl_tmp'); 
--Testcase 181:
DELETE FROM INT8_TBL;
--Testcase 182:
INSERT INTO INT8_TBL(q1) SELECT q1 FROM generate_series('+4567890123456789'::int8, '+4567890123456799'::int8) q1;
--Testcase 183:
SELECT q1 AS generate_series FROM INT8_TBL;
 generate_series  
------------------
 4567890123456789
 4567890123456790
 4567890123456791
 4567890123456792
 4567890123456793
 4567890123456794
 4567890123456795
 4567890123456796
 4567890123456797
 4567890123456798
 4567890123456799
(11 rows)

--Testcase 184:
DELETE FROM INT8_TBL;
--Testcase 185:
INSERT INTO INT8_TBL(q1) SELECT q1 FROM generate_series('+4567890123456789'::int8, '+4567890123456799'::int8, 0) q1; -- should error
psql:sql/15.4/int8.sql:383: ERROR:  step size cannot equal zero
--Testcase 186:
SELECT q1 AS generate_series FROM INT8_TBL;
 generate_series 
-----------------
(0 rows)

--Testcase 187:
DELETE FROM INT8_TBL;
--Testcase 188:
INSERT INTO INT8_TBL(q1) SELECT q1 FROM generate_series('+4567890123456789'::int8, '+4567890123456799'::int8, 2) q1;
--Testcase 189:
SELECT q1 AS generate_series FROM INT8_TBL;
 generate_series  
------------------
 4567890123456789
 4567890123456791
 4567890123456793
 4567890123456795
 4567890123456797
 4567890123456799
(6 rows)

-- corner case
--Testcase 190:
DELETE FROM INT8_TBL;
--Testcase 191:
INSERT INTO INT8_TBL(q1) VALUES(-1::int8<<63);
--Testcase 192:
SELECT q1::text AS text FROM INT8_TBL;
         text         
----------------------
 -9223372036854775808
(1 row)

--Testcase 195:
SELECT (q1+1)::text FROM INT8_TBL;
         text         
----------------------
 -9223372036854775807
(1 row)

-- check sane handling of INT64_MIN overflow cases
--Testcase 196:
DELETE FROM INT8_TBL;
--Testcase 197:
INSERT INTO INT8_TBL(q1) VALUES ((-9223372036854775808)::int8);
--Testcase 198:
SELECT (q1 * (-1)::int8) FROM INT8_TBL;
psql:sql/15.4/int8.sql:414: ERROR:  bigint out of range
--Testcase 199:
DELETE FROM INT8_TBL;
--Testcase 200:
INSERT INTO INT8_TBL(q1) VALUES ((-9223372036854775808)::int8);
--Testcase 201:
SELECT (q1 / (-1)::int8) FROM INT8_TBL;
psql:sql/15.4/int8.sql:420: ERROR:  bigint out of range
--Testcase 202:
DELETE FROM INT8_TBL;
--Testcase 203:
INSERT INTO INT8_TBL(q1) VALUES ((-9223372036854775808)::int8);
--Testcase 204:
SELECT (q1 % (-1)::int8) FROM INT8_TBL;
 ?column? 
----------
        0
(1 row)

--Testcase 205:
DELETE FROM INT8_TBL;
--Testcase 206:
INSERT INTO INT8_TBL(q1) VALUES ((-9223372036854775808)::int8);
--Testcase 207:
SELECT (q1 * (-1)::int4) FROM INT8_TBL;
psql:sql/15.4/int8.sql:432: ERROR:  bigint out of range
--Testcase 208:
DELETE FROM INT8_TBL;
--Testcase 209:
INSERT INTO INT8_TBL(q1) VALUES ((-9223372036854775808)::int8);
--Testcase 210:
SELECT (q1 / (-1)::int4) FROM INT8_TBL;
psql:sql/15.4/int8.sql:438: ERROR:  bigint out of range
--Testcase 211:
DELETE FROM INT8_TBL;
--Testcase 212:
INSERT INTO INT8_TBL(q1) VALUES ((-9223372036854775808)::int8);
--Testcase 213:
SELECT (q1 % (-1)::int4) FROM INT8_TBL;
 ?column? 
----------
        0
(1 row)

--Testcase 214:
DELETE FROM INT8_TBL;
--Testcase 215:
INSERT INTO INT8_TBL(q1) VALUES ((-9223372036854775808)::int8);
--Testcase 216:
SELECT (q1 * (-1)::int2) FROM INT8_TBL;
psql:sql/15.4/int8.sql:450: ERROR:  bigint out of range
--Testcase 217:
DELETE FROM INT8_TBL;
--Testcase 218:
INSERT INTO INT8_TBL(q1) VALUES ((-9223372036854775808)::int8);
--Testcase 219:
SELECT (q1 / (-1)::int2) FROM INT8_TBL;
psql:sql/15.4/int8.sql:456: ERROR:  bigint out of range
--Testcase 220:
DELETE FROM INT8_TBL;
--Testcase 221:
INSERT INTO INT8_TBL(q1) VALUES ((-9223372036854775808)::int8);
--Testcase 222:
SELECT (q1 % (-1)::int2) FROM INT8_TBL;
 ?column? 
----------
        0
(1 row)

-- check rounding when casting from float
--Testcase 233:
CREATE FOREIGN TABLE FLOAT8_TBL(id serial OPTIONS (key 'true'), f1 float8) SERVER :DB_SERVERNAME OPTIONS (schema :DB_SCHEMA, table 'float8_tbl_tmp');;
--Testcase 223:
DELETE FROM FLOAT8_TBL;
--Testcase 224:
INSERT INTO FLOAT8_TBL(f1) VALUES
	     (-2.5::float8),
             (-1.5::float8),
             (-0.5::float8),
             (0.0::float8),
             (0.5::float8),
             (1.5::float8),
             (2.5::float8);
--Testcase 225:
SELECT f1 as x, f1::int8 AS int8_value FROM FLOAT8_TBL;
  x   | int8_value 
------+------------
 -2.5 |         -2
 -1.5 |         -2
 -0.5 |          0
    0 |          0
  0.5 |          0
  1.5 |          2
  2.5 |          2
(7 rows)

 
-- check rounding when casting from numeric
--Testcase 226:
DELETE FROM FLOAT8_TBL;
--Testcase 227:
INSERT INTO FLOAT8_TBL(f1) VALUES
	     (-2.5::numeric),
             (-1.5::numeric),
             (-0.5::numeric),
             (0.0::numeric),
             (0.5::numeric),
             (1.5::numeric),
             (2.5::numeric);
--Testcase 228:
SELECT f1::numeric as x, f1::numeric::int8 AS int8_value FROM FLOAT8_TBL;
  x   | int8_value 
------+------------
 -2.5 |         -3
 -1.5 |         -2
 -0.5 |         -1
    0 |          0
  0.5 |          1
  1.5 |          2
  2.5 |          3
(7 rows)

-- test gcd()
--Testcase 229:
DELETE FROM INT8_TBL;
--Testcase 230:
INSERT INTO INT8_TBL(q1, q2) VALUES (0::int8, 0::int8);
--Testcase 231:
INSERT INTO INT8_TBL(q1, q2) VALUES (0::int8, 29893644334::int8);
--Testcase 232:
INSERT INTO INT8_TBL(q1, q2) VALUES (288484263558::int8, 29893644334::int8);
--Testcase 233:
INSERT INTO INT8_TBL(q1, q2) VALUES (-288484263558::int8, 29893644334::int8);
--Testcase 234:
INSERT INTO INT8_TBL(q1, q2) VALUES ((-9223372036854775808)::int8, 1::int8);
--Testcase 235:
INSERT INTO INT8_TBL(q1, q2) VALUES ((-9223372036854775808)::int8, 9223372036854775807::int8);
--Testcase 236:
INSERT INTO INT8_TBL(q1, q2) VALUES ((-9223372036854775808)::int8, 4611686018427387904::int8);
--Testcase 237:
SELECT q1 AS a, q2 AS b, gcd(q1, q2), gcd(q1, -q2), gcd(q2, q1), gcd(-q2, q1) FROM INT8_TBL;
          a           |          b          |         gcd         |         gcd         |         gcd         |         gcd         
----------------------+---------------------+---------------------+---------------------+---------------------+---------------------
                    0 |                   0 |                   0 |                   0 |                   0 |                   0
                    0 |         29893644334 |         29893644334 |         29893644334 |         29893644334 |         29893644334
         288484263558 |         29893644334 |             6835958 |             6835958 |             6835958 |             6835958
        -288484263558 |         29893644334 |             6835958 |             6835958 |             6835958 |             6835958
 -9223372036854775808 |                   1 |                   1 |                   1 |                   1 |                   1
 -9223372036854775808 | 9223372036854775807 |                   1 |                   1 |                   1 |                   1
 -9223372036854775808 | 4611686018427387904 | 4611686018427387904 | 4611686018427387904 | 4611686018427387904 | 4611686018427387904
(7 rows)

--Testcase 238:
DELETE FROM INT8_TBL;
--Testcase 239:
INSERT INTO INT8_TBL(q1, q2) VALUES ((-9223372036854775808)::int8, 0::int8);
--Testcase 240:
SELECT gcd(q1, q2) FROM INT8_TBL;    -- overflow
psql:sql/15.4/int8.sql:526: ERROR:  bigint out of range
--Testcase 241:
DELETE FROM INT8_TBL;
--Testcase 242:
INSERT INTO INT8_TBL(q1, q2) VALUES ((-9223372036854775808)::int8, (-9223372036854775808)::int8);
--Testcase 243:
SELECT gcd(q1, q2) FROM INT8_TBL;    -- overflow
psql:sql/15.4/int8.sql:532: ERROR:  bigint out of range
-- test lcm()
--Testcase 244:
DELETE FROM INT8_TBL;
--Testcase 245:
INSERT INTO INT8_TBL(q1, q2) VALUES (0::int8, 0::int8);
--Testcase 246:
INSERT INTO INT8_TBL(q1, q2) VALUES (0::int8, 29893644334::int8);
--Testcase 247:
INSERT INTO INT8_TBL(q1, q2) VALUES (29893644334::int8, 29893644334::int8);
--Testcase 248:
INSERT INTO INT8_TBL(q1, q2) VALUES (288484263558::int8, 29893644334::int8);
--Testcase 249:
INSERT INTO INT8_TBL(q1, q2) VALUES (-288484263558::int8, 29893644334::int8);
--Testcase 250:
INSERT INTO INT8_TBL(q1, q2) VALUES ((-9223372036854775808)::int8, 0::int8);
--Testcase 251:
SELECT q1 AS a, q2 AS b, lcm(q1, q2), lcm(q1, -q2), lcm(q2, q1), lcm(-q2, q1) FROM INT8_TBL;
          a           |      b      |       lcm        |       lcm        |       lcm        |       lcm        
----------------------+-------------+------------------+------------------+------------------+------------------
                    0 |           0 |                0 |                0 |                0 |                0
                    0 | 29893644334 |                0 |                0 |                0 |                0
          29893644334 | 29893644334 |      29893644334 |      29893644334 |      29893644334 |      29893644334
         288484263558 | 29893644334 | 1261541684539134 | 1261541684539134 | 1261541684539134 | 1261541684539134
        -288484263558 | 29893644334 | 1261541684539134 | 1261541684539134 | 1261541684539134 | 1261541684539134
 -9223372036854775808 |           0 |                0 |                0 |                0 |                0
(6 rows)

--Testcase 252:
DELETE FROM INT8_TBL;
--Testcase 253:
INSERT INTO INT8_TBL(q1, q2) VALUES ((-9223372036854775808)::int8, 1::int8);
--Testcase 254:
SELECT lcm(q1, q2) FROM INT8_TBL;    -- overflow
psql:sql/15.4/int8.sql:558: ERROR:  bigint out of range
--Testcase 255:
DELETE FROM INT8_TBL;
--Testcase 256:
INSERT INTO INT8_TBL(q1, q2) VALUES (9223372036854775807::int8, 9223372036854775806::int8);
--Testcase 257:
SELECT lcm(q1, q2) FROM INT8_TBL;    -- overflow
psql:sql/15.4/int8.sql:564: ERROR:  bigint out of range
--Testcase 258:
DROP FOREIGN TABLE FLOAT8_TBL;
--Testcase 259:
DROP FOREIGN TABLE INT8_TBL;
--Testcase 260:
DROP USER MAPPING FOR public SERVER :DB_SERVERNAME;
--Testcase 261:
DROP SERVER :DB_SERVERNAME CASCADE;
--Testcase 262:
DROP EXTENSION :DB_EXTENSIONNAME CASCADE;
